version: '3.8'

services:
  solana-dev:
    build: .
    container_name: solana-dev-env
    volumes:
      - .:/workspace
      - cargo-cache:/usr/local/cargo/registry
      - solana-cache:/root/.cache/solana
    working_dir: /workspace
    stdin_open: true
    tty: true
    environment:
      - RUST_LOG=info
    command: /bin/bash

  # 本地 Solana 测试验证器
  solana-test-validator:
    build: .
    container_name: solana-validator
    volumes:
      - validator-ledger:/root/.config/solana/ledger
    ports:
      - "8899:8899"
      - "8900:8900"
    command: solana-test-validator --reset

volumes:
  cargo-cache:
  solana-cache:
  validator-ledger:
