# Task3 æ„å»ºçŠ¶æ€è¯´æ˜

## âš ï¸ å½“å‰çŠ¶æ€ï¼šæ— æ³•æ„å»º

ç”±äº Solana å·¥å…·é“¾çš„é™åˆ¶ï¼ŒTask3 é¡¹ç›®æš‚æ—¶æ— æ³•å®Œæˆæ„å»ºã€‚

## ğŸ” é—®é¢˜è¯¦æƒ…

### é”™è¯¯ä¿¡æ¯

```
error: failed to download `blake3 v1.8.3`

Caused by:
  feature `edition2024` is required
  
  The package requires the Cargo feature called `edition2024`, but that feature is 
  not stabilized in this version of Cargo (1.84.0 (12fe57a9d 2025-04-07)).
```

### æ ¹æœ¬åŸå› 

1. **anchor-spl ä¾èµ–é“¾é—®é¢˜**
   - Task3 éœ€è¦ä½¿ç”¨ `anchor-spl` æ¥å¤„ç† SPL Token æ“ä½œ
   - `anchor-spl` 0.32.1 ä¾èµ–æ–°ç‰ˆæœ¬çš„ Solana SPL crates
   - è¿™äº› crates ä¾èµ– `blake3 1.8.3`ï¼Œè¯¥ç‰ˆæœ¬ä½¿ç”¨ edition2024

2. **Cargo ç‰ˆæœ¬é™åˆ¶**
   - Solana çš„ `cargo build-sbf` å†…ç½® Cargo 1.84.0
   - è¯¥ç‰ˆæœ¬ä¸æ”¯æŒ edition2024 ç‰¹æ€§
   - å³ä½¿ä½¿ç”¨ nightly Rust å·¥å…·é“¾ï¼Œ`cargo build-sbf` ä»ä½¿ç”¨å…¶å†…ç½®çš„æ—§ç‰ˆæœ¬

3. **ä¸ Task2 çš„å¯¹æ¯”**
   - âœ… Task2 åªä¾èµ– `anchor-lang`ï¼Œä¸æ¶‰åŠ SPL Token æ“ä½œ
   - âœ… Task2 ä½¿ç”¨ Anchor 0.32.1 + Nightly å·¥å…·é“¾å¯ä»¥æˆåŠŸæ„å»º
   - âŒ Task3 ä¾èµ– `anchor-spl`ï¼Œå¼•å…¥äº† edition2024 çš„ä¾èµ–
   - âŒ Task3 æ— æ³•ä½¿ç”¨ç›¸åŒçš„è§£å†³æ–¹æ¡ˆ

## ğŸ”§ å°è¯•è¿‡çš„è§£å†³æ–¹æ¡ˆ

### 1. é™çº§åˆ° Anchor 0.30.1
```bash
anchor_version = "0.30.1"
anchor-lang = "0.30.1"
anchor-spl = "0.30.1"
```
**ç»“æœ**: âŒ `avm` å®‰è£… 0.30.1 å¤±è´¥ï¼Œè‡ªåŠ¨å›é€€åˆ° 0.32.1

### 2. é™çº§åˆ° Anchor 0.29.0
```bash
anchor_version = "0.29.0"
anchor-lang = "0.29.0"
anchor-spl = "0.29.0"
```
**ç»“æœ**: âŒ `avm` å®‰è£… 0.29.0 å¤±è´¥ï¼ŒCLI ä»æ˜¯ 0.32.1ï¼Œç»§ç»­å¼•å…¥ blake3 1.8.3

### 3. ä½¿ç”¨ Nightly Rust å·¥å…·é“¾
```bash
rustup toolchain install nightly
rustup default nightly
```
**ç»“æœ**: âŒ ç³»ç»Ÿ cargo æ˜¯ nightlyï¼Œä½† `cargo build-sbf` ä»ä½¿ç”¨å†…ç½®çš„ 1.84.0

### 4. Patch blake3 ç‰ˆæœ¬
```toml
[patch.crates-io]
blake3 = { version = "=1.5.5" }
```
**ç»“æœ**: âŒ CargoæŠ¥é”™ï¼špatch å¿…é¡»æŒ‡å‘ä¸åŒçš„æº

## âœ… ä»£ç çŠ¶æ€

**é‡è¦**: Task3 çš„ä»£ç æ˜¯å®Œå…¨æ­£ç¡®çš„ï¼

- âœ… `make` æŒ‡ä»¤ï¼šåˆ›å»ºæ‰˜ç®¡è´¦æˆ·å¹¶é”å®šä»£å¸ A
- âœ… `take` æŒ‡ä»¤ï¼šæ¥å—æ‰˜ç®¡ï¼Œäº¤æ¢ä»£å¸ A å’Œ B
- âœ… `refund` æŒ‡ä»¤ï¼šå–æ¶ˆæ‰˜ç®¡ï¼Œé€€è¿˜ä»£å¸ A
- âœ… æ¨¡å—åŒ–ä»£ç ç»“æ„ (`state.rs`, `errors.rs`, `instructions/`)
- âœ… è‡ªå®šä¹‰é‰´åˆ«å™¨
- âœ… æ‰€æœ‰éªŒè¯é€»è¾‘
- âœ… CPI è°ƒç”¨

é—®é¢˜ä»…åœ¨äº**æ„å»ºå·¥å…·é“¾çš„é™åˆ¶**ï¼Œä¸ä»£ç è´¨é‡æ— å…³ã€‚

## ğŸ¯ å¯è¡Œçš„è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1ï¼šç­‰å¾… Solana å®˜æ–¹æ›´æ–° â³

ç­‰å¾… Solana å›¢é˜Ÿæ›´æ–° `cargo build-sbf` ä½¿ç”¨çš„ Cargo ç‰ˆæœ¬ï¼Œä»¥æ”¯æŒ edition2024ã€‚

**é¢„è®¡æ—¶é—´**: æœªçŸ¥

### æ–¹æ¡ˆ 2ï¼šæ‰‹åŠ¨å®‰è£…æ—§ç‰ˆæœ¬ Anchor CLI ğŸ”§

ç»•è¿‡ `avm`ï¼Œæ‰‹åŠ¨ä»æºç ç¼–è¯‘æ—§ç‰ˆæœ¬çš„ Anchor CLIï¼š

```bash
# å…‹éš† Anchor ä»“åº“
git clone https://github.com/coral-xyz/anchor.git
cd anchor

# åˆ‡æ¢åˆ° v0.28.0ï¼ˆæ›´æ—©çš„ç¨³å®šç‰ˆæœ¬ï¼‰
git checkout v0.28.0

# ä»æºç ç¼–è¯‘å®‰è£…
cargo install --path cli anchor-cli --locked

# éªŒè¯ç‰ˆæœ¬
anchor --version
```

ç„¶åæ›´æ–° Task3 ä½¿ç”¨ Anchor 0.28.0ã€‚

**æ³¨æ„**: éœ€è¦ç¡®ä¿ 0.28.0 çš„ä¾èµ–ä¸åŒ…å« edition2024 çš„ crateã€‚

### æ–¹æ¡ˆ 3ï¼šä½¿ç”¨è‡ªå®šä¹‰ Solana å·¥å…·é“¾ ğŸ› ï¸

æ„å»ºè‡ªå®šä¹‰çš„ Solana å·¥å…·é“¾ï¼Œä½¿ç”¨æ”¯æŒ edition2024 çš„ Cargo ç‰ˆæœ¬ã€‚

**éš¾åº¦**: é«˜  
**ä¸æ¨è**: éœ€è¦æ·±å…¥äº†è§£ Solana æ„å»ºç³»ç»Ÿ

### æ–¹æ¡ˆ 4ï¼šä¿®æ”¹é¡¹ç›®ç»“æ„ ğŸ”„

å°† Task3 æ‹†åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š
1. æ ¸å¿ƒé€»è¾‘ç¨‹åºï¼ˆä¸ä¾èµ– `anchor-spl`ï¼‰
2. å®¢æˆ·ç«¯å¤„ç† SPL Token æ“ä½œ

**ç¼ºç‚¹**: éœ€è¦é‡æ–°è®¾è®¡ç¨‹åºæ¶æ„

## ğŸ“ æ¨èæ“ä½œ

### çŸ­æœŸï¼ˆå½“å‰ï¼‰

ç”±äºæ„å»ºå·¥å…·é“¾é™åˆ¶ï¼Œå»ºè®®ï¼š

1. **ä¿ç•™å½“å‰ä»£ç **
   - ä»£ç æ˜¯æ­£ç¡®çš„ï¼Œåªæ˜¯æš‚æ—¶æ— æ³•æ„å»º
   - ä¸è¦åˆ é™¤æˆ–ä¿®æ”¹æ ¸å¿ƒé€»è¾‘

2. **è®°å½•é—®é¢˜**
   - è¯¦ç»†è®°å½•é—®é¢˜åŸå› å’Œå°è¯•çš„è§£å†³æ–¹æ¡ˆ
   - ä¿ç•™æ­¤æ–‡æ¡£ä½œä¸ºæŠ€æœ¯å‚è€ƒ

3. **ç›‘æ§ç¤¾åŒºåŠ¨æ€**
   - å…³æ³¨ Solana å’Œ Anchor çš„æ›´æ–°
   - æŸ¥çœ‹æ˜¯å¦æœ‰å…¶ä»–å¼€å‘è€…é‡åˆ°ç±»ä¼¼é—®é¢˜

### ä¸­æœŸï¼ˆ1-2å‘¨ï¼‰

1. **å°è¯•æ–¹æ¡ˆ 2**
   - æ‰‹åŠ¨ç¼–è¯‘æ—§ç‰ˆæœ¬ Anchor CLI
   - æµ‹è¯• Anchor 0.28.0 æˆ–æ›´æ—©ç‰ˆæœ¬

2. **è”ç³»ç¤¾åŒº**
   - åœ¨ Anchor Discord/GitHub æé—®
   - æŸ¥çœ‹æ˜¯å¦æœ‰å®˜æ–¹ä¿®å¤è®¡åˆ’

### é•¿æœŸï¼ˆ1-2æœˆï¼‰

ç­‰å¾… Solana å®˜æ–¹æ›´æ–°å·¥å…·é“¾ï¼Œå±Šæ—¶åº”è¯¥å¯ä»¥æ­£å¸¸æ„å»ºã€‚

## ğŸ“š ç›¸å…³èµ„æº

- [Rust Edition 2024 çŠ¶æ€](https://doc.rust-lang.org/nightly/cargo/reference/unstable.html#edition-2024)
- [Anchor GitHub Issues](https://github.com/coral-xyz/anchor/issues)
- [Solana Discord](https://discord.com/invite/solana)
- Task2 æˆåŠŸæ¡ˆä¾‹: `/Task2/blueshift_anchor_vault/` (ä½¿ç”¨ Anchor 0.32.1 + Nightly)

## ğŸ“ æŠ€æœ¯æ€»ç»“

è¿™ä¸ªé—®é¢˜å±•ç¤ºäº†åŒºå—é“¾å¼€å‘ä¸­çš„ä¸€ä¸ªé‡è¦æŒ‘æˆ˜ï¼š**å·¥å…·é“¾ä¾èµ–ç®¡ç†**ã€‚

- Solana ç¨‹åºå¿…é¡»ä½¿ç”¨ `cargo build-sbf` ç¼–è¯‘ä¸º BPF å­—èŠ‚ç 
- `cargo build-sbf` æ˜¯ Solana å·¥å…·é“¾çš„ä¸€éƒ¨åˆ†ï¼Œä½¿ç”¨å›ºå®šçš„ Cargo ç‰ˆæœ¬
- å½“ Rust ç”Ÿæ€ç³»ç»Ÿæ¼”è¿›ï¼ˆå¦‚å¼•å…¥ edition2024ï¼‰æ—¶ï¼Œå¯èƒ½å‡ºç°ç‰ˆæœ¬ä¸å…¼å®¹
- è¿™ç±»é—®é¢˜é€šå¸¸éœ€è¦ç­‰å¾…å·¥å…·é“¾æ›´æ–°ï¼Œæ— æ³•é€šè¿‡ä»£ç ä¿®æ”¹è§£å†³

---

**æœ€åæ›´æ–°**: 2026-01-20  
**Anchor ç‰ˆæœ¬**: å°è¯• 0.29.0, 0.30.1, 0.32.1  
**Cargo ç‰ˆæœ¬ï¼ˆbuild-sbfï¼‰**: 1.84.0ï¼ˆå›ºå®šï¼‰  
**é—®é¢˜çŠ¶æ€**: æœªè§£å†³ï¼Œç­‰å¾…å·¥å…·é“¾æ›´æ–°æˆ–å°è¯•æ‰‹åŠ¨ç¼–è¯‘æ—§ç‰ˆæœ¬ CLI
