# å®Œæ•´é¡¹ç›®ä½¿ç”¨æŒ‡å—

## ğŸ“‚ é¡¹ç›®ä½ç½®

```
/Users/dean/code/web3/solana-2026-task/Task2/blueshift_anchor_vault/
```

## âœ¨ é¡¹ç›®å·²åŒ…å«

è¿™æ˜¯ä¸€ä¸ª**å¼€ç®±å³ç”¨**çš„å®Œæ•´ Anchor é¡¹ç›®ï¼ŒåŒ…å«ï¼š

### ğŸ“ æ ¸å¿ƒæ–‡ä»¶
- âœ… `programs/blueshift_anchor_vault/src/lib.rs` - å®Œæ•´çš„ç¨‹åºä»£ç ï¼ˆå¸¦ 300+ è¡Œä¸­æ–‡æ³¨é‡Šï¼‰
- âœ… `tests/blueshift_anchor_vault.ts` - 6 ä¸ªå®Œæ•´æµ‹è¯•ç”¨ä¾‹
- âœ… `Anchor.toml` - Anchor é…ç½®æ–‡ä»¶
- âœ… `Cargo.toml` - Rust å·¥ä½œç©ºé—´é…ç½®
- âœ… `package.json` - Node.js ä¾èµ–é…ç½®
- âœ… `tsconfig.json` - TypeScript é…ç½®

### ğŸ› ï¸ è¾…åŠ©è„šæœ¬
- âœ… `setup.sh` - è‡ªåŠ¨åŒ–è®¾ç½®è„šæœ¬ï¼ˆæ£€æŸ¥ä¾èµ–ã€æ„å»ºç¨‹åºï¼‰
- âœ… `deploy.sh` - å¤šç½‘ç»œéƒ¨ç½²è„šæœ¬
- âœ… `README.md` - è¯¦ç»†çš„ä½¿ç”¨æ–‡æ¡£
- âœ… `START_HERE.md` - å¿«é€Ÿå¯åŠ¨æŒ‡å—

### ğŸ¯ ç¨‹åºåŠŸèƒ½
1. **Depositï¼ˆå­˜æ¬¾ï¼‰** - å°† SOL å­˜å…¥ä¸ªäººé‡‘åº“
2. **Withdrawï¼ˆå–æ¬¾ï¼‰** - ä»ä¸ªäººé‡‘åº“å–å‡ºæ‰€æœ‰ SOL

## ğŸš€ ä½¿ç”¨æ­¥éª¤

### æ–¹å¼ä¸€ï¼šè‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆæœ€ç®€å•ï¼‰

```bash
cd /Users/dean/code/web3/solana-2026-task/Task2/blueshift_anchor_vault
./setup.sh
```

è¿™ä¸ªè„šæœ¬ä¼šï¼š
1. âœ… æ£€æŸ¥æ‰€æœ‰å¿…éœ€çš„å·¥å…·ï¼ˆRustã€Solanaã€Anchorã€Node.jsï¼‰
2. âœ… å®‰è£… npm ä¾èµ–
3. âœ… é…ç½® Solana é’±åŒ…ï¼ˆå¦‚æœä¸å­˜åœ¨ä¼šåˆ›å»ºï¼‰
4. âœ… è®¾ç½®æœ¬åœ°ç½‘ç»œ
5. âœ… æ„å»ºç¨‹åº

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨æ­¥éª¤

#### 1. è¿›å…¥é¡¹ç›®ç›®å½•
```bash
cd /Users/dean/code/web3/solana-2026-task/Task2/blueshift_anchor_vault
```

#### 2. å®‰è£… Node.js ä¾èµ–
```bash
yarn install
# æˆ–
npm install
```

#### 3. æ„å»ºç¨‹åº
```bash
anchor build
```

æ„å»ºæˆåŠŸåä¼šç”Ÿæˆï¼š
- `target/deploy/blueshift_anchor_vault.so` - ç¨‹åºæ–‡ä»¶
- `target/idl/blueshift_anchor_vault.json` - IDL æ–‡ä»¶
- `target/types/blueshift_anchor_vault.ts` - TypeScript ç±»å‹æ–‡ä»¶

#### 4. è¿è¡Œæµ‹è¯•

**é€‰é¡¹ A: è‡ªåŠ¨å¯åŠ¨éªŒè¯å™¨ï¼ˆæ¨èï¼‰**
```bash
anchor test
```

**é€‰é¡¹ B: ä½¿ç”¨å·²è¿è¡Œçš„éªŒè¯å™¨**

ç»ˆç«¯ 1ï¼š
```bash
solana-test-validator
```

ç»ˆç«¯ 2ï¼š
```bash
anchor test --skip-local-validator
```

#### 5. éƒ¨ç½²ç¨‹åº

**æœ¬åœ°éƒ¨ç½²ï¼š**
```bash
anchor deploy
```

**å¤šç½‘ç»œéƒ¨ç½²ï¼ˆä½¿ç”¨è„šæœ¬ï¼‰ï¼š**
```bash
./deploy.sh
```
ç„¶åé€‰æ‹©ï¼š
- 1 = æœ¬åœ°ç½‘ç»œ (localhost)
- 2 = å¼€å‘ç½‘ç»œ (devnet)
- 3 = æµ‹è¯•ç½‘ç»œ (testnet)

## ğŸ“Š æµ‹è¯•ç”¨ä¾‹è¯´æ˜

é¡¹ç›®åŒ…å« 6 ä¸ªå®Œæ•´æµ‹è¯•ï¼š

1. âœ… **æˆåŠŸå­˜æ¬¾åˆ°é‡‘åº“** - éªŒè¯æ­£å¸¸å­˜æ¬¾æµç¨‹
2. âœ… **é‡å¤å­˜æ¬¾åº”è¯¥å¤±è´¥** - éªŒè¯ä¸èƒ½é‡å¤å­˜æ¬¾
3. âœ… **å°é¢å­˜æ¬¾åº”è¯¥å¤±è´¥** - éªŒè¯é‡‘é¢å¿…é¡»å¤§äºå…ç§Ÿé‡‘é™é¢
4. âœ… **æˆåŠŸä»é‡‘åº“å–æ¬¾** - éªŒè¯æ­£å¸¸å–æ¬¾æµç¨‹
5. âœ… **ä»ç©ºé‡‘åº“å–æ¬¾åº”è¯¥å¤±è´¥** - éªŒè¯ä¸èƒ½ä»ç©ºé‡‘åº“å–æ¬¾
6. âœ… **å¤šæ¬¡å­˜å–å¾ªç¯** - éªŒè¯å¯ä»¥å¤šæ¬¡å­˜å–

è¿è¡Œæµ‹è¯•æ—¶ä¼šçœ‹åˆ°è¯¦ç»†çš„æ—¥å¿—è¾“å‡ºã€‚

## ğŸ” éªŒè¯æ„å»º

### æ£€æŸ¥æ„å»ºäº§ç‰©
```bash
ls -lh target/deploy/
```

åº”è¯¥çœ‹åˆ°ï¼š
- `blueshift_anchor_vault.so` - ç¨‹åºæ–‡ä»¶ï¼ˆçº¦ 200-400 KBï¼‰
- `blueshift_anchor_vault-keypair.json` - ç¨‹åºå¯†é’¥å¯¹

### æŸ¥çœ‹ç¨‹åºä¿¡æ¯
```bash
solana program show 22222222222222222222222222222222222222222222
```

### æŸ¥çœ‹ IDL
```bash
cat target/idl/blueshift_anchor_vault.json
```

## ğŸ› å¸¸è§é—®é¢˜

### é—®é¢˜ 1: æ‰¾ä¸åˆ° anchor å‘½ä»¤
```bash
# å®‰è£… Anchor
cargo install --git https://github.com/coral-xyz/anchor avm --locked --force
avm install latest
avm use latest
```

### é—®é¢˜ 2: æ„å»ºå¤±è´¥
```bash
# æ¸…ç†å¹¶é‡æ–°æ„å»º
anchor clean
anchor build
```

### é—®é¢˜ 3: æµ‹è¯•è¶…æ—¶
```bash
# ç¡®ä¿éªŒè¯å™¨æ­£åœ¨è¿è¡Œ
solana-test-validator

# åœ¨å¦ä¸€ä¸ªç»ˆç«¯è¿è¡Œæµ‹è¯•
anchor test --skip-local-validator
```

### é—®é¢˜ 4: æ‰¾ä¸åˆ°é’±åŒ…
```bash
# åˆ›å»ºæ–°é’±åŒ…
solana-keygen new --no-bip39-passphrase
```

### é—®é¢˜ 5: ç«¯å£è¢«å ç”¨
```bash
# æ€æ­»å ç”¨ç«¯å£çš„è¿›ç¨‹
lsof -ti:8899 | xargs kill -9
```

## ğŸ“ é‡è¦é…ç½®

### ç¨‹åº IDï¼ˆå·²å›ºå®šï¼‰
```
22222222222222222222222222222222222222222222
```

è¿™ä¸ª ID åœ¨ä»¥ä¸‹æ–‡ä»¶ä¸­é…ç½®ï¼š
- `Anchor.toml`
- `programs/blueshift_anchor_vault/src/lib.rs` (declare_id!)

### ç½‘ç»œé…ç½®
åœ¨ `Anchor.toml` ä¸­å·²é…ç½®ä¸‰ä¸ªç½‘ç»œï¼š
- localnet
- devnet
- testnet

## ğŸ“ ä»£ç äº®ç‚¹

### 1. è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Š
ç¨‹åºä»£ç åŒ…å« 300+ è¡Œè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼Œè§£é‡Šï¼š
- æ¯ä¸ªå‡½æ•°çš„åŠŸèƒ½å’Œå‚æ•°
- PDA æ´¾ç”Ÿè¿‡ç¨‹
- CPI è°ƒç”¨æœºåˆ¶
- å®‰å…¨éªŒè¯é€»è¾‘

### 2. å®Œæ•´çš„é”™è¯¯å¤„ç†
```rust
#[error_code]
pub enum VaultError {
    VaultAlreadyExists,  // é‡‘åº“å·²å­˜åœ¨
    InvalidAmount,       // æ— æ•ˆé‡‘é¢
}
```

### 3. å®‰å…¨çš„ PDA è®¾è®¡
```rust
seeds = [b"vault", signer.key().as_ref()]
```

æ¯ä¸ªç”¨æˆ·æœ‰å”¯ä¸€çš„é‡‘åº“åœ°å€ã€‚

### 4. å¸¦éªŒè¯çš„ CPI è½¬è´¦
ä½¿ç”¨ `require_eq!`ã€`require_gt!`ã€`require_neq!` ç­‰å®è¿›è¡Œå®‰å…¨æ£€æŸ¥ã€‚

## ğŸ“š å­¦ä¹ èµ„æº

é¡¹ç›®ä¸­çš„æ¯ä¸ªæ–‡ä»¶éƒ½æœ‰è¯¦ç»†æ³¨é‡Šï¼Œå»ºè®®æŒ‰ä»¥ä¸‹é¡ºåºå­¦ä¹ ï¼š

1. `START_HERE.md` - å¿«é€Ÿå¼€å§‹
2. `README.md` - è¯¦ç»†æ–‡æ¡£
3. `programs/blueshift_anchor_vault/src/lib.rs` - ç¨‹åºæºç 
4. `tests/blueshift_anchor_vault.ts` - æµ‹è¯•ç”¨ä¾‹

## ğŸ‰ æˆåŠŸæ ‡å¿—

å½“æ‚¨çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºæ—¶ï¼Œè¯´æ˜ä¸€åˆ‡æ­£å¸¸ï¼š

```
âœ“ åº”è¯¥æˆåŠŸå­˜æ¬¾åˆ°é‡‘åº“
âœ“ é‡å¤å­˜æ¬¾åº”è¯¥å¤±è´¥
âœ“ å°é¢å­˜æ¬¾åº”è¯¥å¤±è´¥
âœ“ åº”è¯¥æˆåŠŸä»é‡‘åº“å–æ¬¾
âœ“ ä»ç©ºé‡‘åº“å–æ¬¾åº”è¯¥å¤±è´¥
âœ“ åº”è¯¥æ”¯æŒå¤šæ¬¡å­˜å–å¾ªç¯

6 passing
```

## ğŸ’¡ ä¸‹ä¸€æ­¥

1. **é˜…è¯»æºä»£ç ** - ç†è§£ PDA å’Œ CPI çš„å®ç°
2. **ä¿®æ”¹ç¨‹åº** - å°è¯•æ·»åŠ æ–°åŠŸèƒ½ï¼ˆå¦‚éƒ¨åˆ†æå–ã€æ—¶é—´é”ç­‰ï¼‰
3. **éƒ¨ç½²åˆ° devnet** - åœ¨çœŸå®ç½‘ç»œä¸Šæµ‹è¯•
4. **æ„å»ºå‰ç«¯** - åˆ›å»ºç”¨æˆ·ç•Œé¢

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æ£€æŸ¥ `README.md` ä¸­çš„æ•…éšœæ’æŸ¥éƒ¨åˆ†
2. è¿è¡Œ `./setup.sh` é‡æ–°è®¾ç½®
3. æŸ¥çœ‹ Anchor å®˜æ–¹æ–‡æ¡£ï¼šhttps://www.anchor-lang.com/

---

**é¡¹ç›®çŠ¶æ€ï¼šâœ… å®Œæ•´å¯ç”¨**  
**æœ€åæ›´æ–°ï¼š2026-01-20**

ç¥æ‚¨å¼€å‘æ„‰å¿«ï¼ğŸš€
